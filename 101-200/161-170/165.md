# 165 : 交点

線分は二つの端点によって一意に決まる.
平面上の2つの線分を考えると以下の3つの可能性がある,
共有点が0個のケース, 共有点が1個のケース, 無限に多くの共有点を持つケース.

さらに, 2つの線分が共有点を1つのみ持つとき, 共有点がどちらかまたは両方の線分の端点である場合がある. もし共有点がどちらの線分の端点でもないなら, その点は両方の線分の内部の点である.
もし, 線分 $$L_{1}$$ と $$L_{2}$$ の共有点Tが $$L_{1}$$ と $$L_{2}$$ の唯一の共有点であり, 両方の線分の内部の点であるとき, $$T$$を真の交点と呼ぶことにする.

3つの線分 $$L_{1}$$, $$L_{2}$$, $$L_{3}$$ を考える.

$$
\begin{aligned}
L_{1}: (27, 44)\ \text{から}\ (12, 32) \\
L_{2}: (46, 53)\ \text{から}\ (17, 62) \\
L_{3}: (46, 70)\ \text{から}\ (22, 40)
\end{aligned}
$$

$$L_{2}$$ と $$L_{3}$$ は真の交点を持つことが確かめられる. $$L_{3}$$ の1つの端点の(22,40)は $$L_{1}$$ 上にあるが, これは真の交点とならないことに注意. $$L_{1}$$ と $$L_{2}$$ は共有点を持たない. つまり上の, 3つの線分では, 真の交点は1つとなる.

いま, 同じことを5000個の線分に対して行うことにする. そのために, 20000個の数を"Blum Blum Shub"と呼ばれる擬似乱数生成法によって生成する.

$$
\begin{aligned}
&s_{0} = 290797 \\
&s_{n+1} = s_{n} \times s_{n} (\text{modulo}\ 50515093) \\
&t_{n} = s_{n} (\text{modulo}\ 500)
\end{aligned}
$$
それぞれの線分を4つの連続する $$t_{n}$$ によって決める. つまり, 最初の線分は,

$$(t_{1}, t_{2})$$ から $$(t_{3}, t_{4})$$ と与えられる.

最初の4つの数は上の生成法によって, 27, 144, 12, 232 となる. 最初の線分は, (27,144) から (12,232) となる.

上の5000個の線分に対して, いくつの相異なった真の交点が存在するか?
