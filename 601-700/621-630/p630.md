# 630 : 交差する線

重複のない直線の集合 $$L$$ が与えられたとき、 この集合の中の線の本数を $$M(L)$$、 それぞれの線が集合内の他の線と交差している回数の総和を $$S(L)$$ とする。 例えば、3本の線の2つの集合を下図に示す：

![](<../../.gitbook/assets/image (3).png>)

どちらの場合も、$$M(L)$$ は 3 で $$S(L)$$ は 6 である。 3本の線はそれぞれ、他の2本の線と交差している。 線が1点で交差していても、個々の線の交差はすべて別に数えることに注意せよ。

整数 $$k \geq 1$$ に対して点 $$(T_{2k-1}, T_{2k})$$ を考える。これは以下のように生成する：

$$S_0 = 290797$$\
$$S_{n+1} = {S_n}^2 \bmod 50515093$$\
$$T_n = (S_n \bmod 2000) - 1000$$

例えば、最初の3つの点は (527, 144), (-488, 732), (-454, -947) である。 この方法で生成された点群の最初の $$n$$ 個が与えられたとき、それぞれの点を他の点と結んで作られる、**他と異なる**(unique)直線の集合を $$L_n$$ とする。 直線は両方向に無限に延長される。 次に、上記のように $$M(L_n)$$ と $$S(L_n)$$ を定義する。

例えば、$$M(L_3) = 3,$$ $$S(L_3) = 6$$ である。 また、$$M(L_{100}) = 4948$$, $$S(L_{100}) = 24477690$$ である。

$$S(L_{2500})$$ はいくつか。
